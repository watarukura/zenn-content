---
title: "ndiagã§AWSã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã"
emoji: "ğŸ™†"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ndiag, document]
published: true
---

## What's

[ndiag](https://github.com/k1LoW/ndiag) ãŒç´ æ•µãªã®ã§AWSä¸Šã«æ§‹ç¯‰ã—ãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã„ã¦ã¿ã¾ã™ã€‚
ndiag@v0.13.2ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚

â†“ã§ãã‚ãŒã‚Šã¯ã“ã¡ã‚‰
<https://github.com/watarukura/ndiag-study>

## æº–å‚™

<https://github.com/k1LoW/ndiag/blob/main/README.md#install> ã‚’å‚ç…§ã€‚
goã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã§ã™ã®ã§ã€`go get`ã—ã¾ã—ãŸã€‚

```bash
go get github.com/k1LoW/ndiag
```

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã£ã¦ã€AWSã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€‚

```bash
mkdir -p aws_doc_sample
cd $_
ndiag fetch-icons aws
```

## æ›¸ãå§‹ã‚ã‚‹

ã¨ã‚Šã‚ãˆãšãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ä¸€å‘¨ã—ã¾ã—ãŸã€‚
<https://github.com/k1LoW/ndiag/blob/main/docs/tutorial.ja.md>

ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®é †ã«ã€nodesã‚’æ›¸ã„ã¦ã¿ã¦`ndiag doc --rm-dist`ã€networksã‚’æ›¸ã„ã¦`ndiag ...`ã€relationsã‚’æ›¸ã„ã¦ä»¥ä¸‹ç•¥ã€ã¨ã™ã‚‹ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚

ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚­ãƒ¼ã¯`ndiag list icons`ã§è¡¨ç¤ºã§ãã‚‹ã®ã§ã€ã“ã‚Œã‚’è¦‹ãªãŒã‚‰ndiag.ymlã«æ›¸ãè¾¼ã‚“ã§ã„ãã¾ã™ã€‚
![VSCodeã§ndiag.ymlã‚’æ›¸ã„ã¦ã„ã‚‹ã¨ã“ã‚](https://raw.githubusercontent.com/watarukura/zenn-content/main/articles/images/20210330_vscode.png)

VSCode Extensionsã§[Markdown Preview Enhanced](https://marketplace.visualstudio.com/items?itemName=shd101wyy.markdown-preview-enhanced)ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚
Previewã‚’è¦‹ãªãŒã‚‰ndiag.ymlã‚’æ›¸ã„ã¦ã¯ç”Ÿæˆã€æ›¸ã„ã¦ã¯ç”Ÿæˆã—ã¾ã™ã€‚

## ã¨ã‚Šã‚ãˆãš

```yaml
---
name: Sample AWS web service
docPath: docs/arch
views:
  -
    name: overview
nodes:
  -
    name: cdn
    components:
      - CloudFront?icon=aws-cloud-front
      - Waf?icon=aws-waf
  -
    name: frontend
    components:
      - Beanstalk?icon=aws-res-elastic-beanstalk-application
  -
    name: api
    components:
      - ECS?icon=aws-res-elastic-container-service-service
  -
    name: db
    components:
      - AuroraMySQL?icon=aws-aurora 
  -
    name: dynamodb
    components:
      - DynamoDB?icon=aws-dynamo-db
networks:
  -
    route:
      - "internet"
      - "cdn:CloudFront"
  -
    route:
      - "cdn:CloudFront"
      - "frontend:Beanstalk"
  -
    route:
      - "frontend:Beanstalk"
      - "api:ECS"
  -
    route:
      - "api:ECS"
      - "dynamodb:DynamoDB"
  -
    route:
      - "api:ECS"
      - "db:AuroraMySQL"
  -
    route:
      - "api:ECS"
      - "Payment API"
relations:
  -
    components:
      - "cdn:CloudFront"
      - "cdn:Waf"
```

![AWSã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](https://raw.githubusercontent.com/watarukura/zenn-content/bed5f482d2f06c2b3366e026bceaf97a80e44bbe/articles/images/20210330_ndiag.png)

## æ„Ÿæƒ³

ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æã„ãŸã‚‚ã®ã®æ›´æ–°ãŒå„„åŠ«ã«ãªã‚Šã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°ã‚’å¿˜ã‚Œã¦ã„ã¦æ–°äººã•ã‚“ã¸ã®èª¬æ˜è³‡æ–™ã«ä½¿ãˆãªã„ã€ã¿ãŸã„ãªäº‹æ…‹ãŒã¾ã¾ã‚ã‚Šã¾ã—ãŸâ€¦ã€‚
<!-- textlint-disable -->
ndiagã‚’ä½¿ã£ã¦GitHubç­‰ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã™ã‚‹ã‚ˆã†ã«ã™ã‚Œã°ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ›´æ–°æ™‚ã«Issue/Pull Requestã‚’ä½œã‚‹é‹ç”¨ã«ã—ãŸã‚Šã€æ—¢å­˜ã®æ§‹æˆã¨ã®å·®åˆ†ãŒç™ºç”Ÿã—ãŸã¨ãã«æ¤œçŸ¥ã•ã›ãŸã‚Šã€ã¨ã„ã†ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã€‚
<!-- textlint-enable -->
AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆ -> VPC -> AZã§ã†ã¾ãClusterã‚’ä½œã£ã¦ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã—ãŸã‚Šã€Elastic Beanstalkã®ä¸­ã§ALBã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã‹CLBã®ã¾ã¾ãªã®ã‹ã‚’æ®µéšçš„ã«è©³ç´°åŒ–ã—ãŸã‚Šã€‚å·¥å¤«æ¬¡ç¬¬ã§æ–°ãƒ¡ãƒ³ãƒãƒ¼ã¸ã®èª¬æ˜ã«ä½¿ã„ã‚„ã™ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œã‚Œãã†ã§ã™ã€‚
